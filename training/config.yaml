# Curriculum training configuration for Space Dogfight RL agent.
# See SPEC.md ยง16.8 for curriculum design rationale.

ppo:
  learning_rate: 5.0e-5
  n_steps: 2048
  batch_size: 256
  n_epochs: 10
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2
  ent_coef: 0.01
  vf_coef: 0.5
  max_grad_norm: 0.5

policy:
  net_arch:
    pi: [256, 256, 256]
    vf: [256, 256, 256]
  activation_fn: ReLU

stages:
  1:
    description: "Learn thrust, aim, fire against stationary target"
    shipHP: 10
    maxTicks: 3600
    asteroidDensity: 0.0
    enemyPolicy: "static"
    enemyShoots: false
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    promotionThreshold: 0.8
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  2:
    description: "Learn lead targeting and pursuit against moving enemy"
    shipHP: 10
    maxTicks: 3600
    asteroidDensity: 0.0
    enemyPolicy: "reactive"
    enemyShoots: false
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    promotionThreshold: 0.8
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  3:
    description: "Learn evasion plus offense against shooting enemy"
    shipHP: 5
    maxTicks: 3600
    asteroidDensity: 0.0
    enemyPolicy: "reactive"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    promotionThreshold: 0.8
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  4:
    description: "Learn to fight predictive enemy without asteroids"
    shipHP: 3
    maxTicks: 3600
    asteroidDensity: 0.0
    enemyPolicy: "predictive"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    aiHoldTime: 0.25
    aiSimSteps: 10
    promotionThreshold: 0.8
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  5:
    description: "Intro to asteroids: very sparse field, more HP for mistakes"
    shipHP: 5
    maxTicks: 3600
    asteroidDensity: 0.1
    enemyPolicy: "predictive"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    aiHoldTime: 0.25
    aiSimSteps: 10
    promotionThreshold: 0.7
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  6:
    description: "Fight predictive enemy in sparse asteroid field"
    shipHP: 3
    maxTicks: 3600
    asteroidDensity: 0.3
    enemyPolicy: "predictive"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    aiHoldTime: 0.25
    aiSimSteps: 10
    promotionThreshold: 0.7
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.3
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  7:
    description: "Full game conditions with normal asteroid density"
    shipHP: 1
    maxTicks: 3600
    asteroidDensity: 1.0
    enemyPolicy: "predictive"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    aiHoldTime: 0.25
    aiSimSteps: 10
    promotionThreshold: 0.85
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.5
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  8:
    description: "Full game against optimized predictive enemy (lead-angle firing)"
    shipHP: 1
    maxTicks: 3600
    asteroidDensity: 1.0
    enemyPolicy: "predictive-optimized"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    aiHoldTime: 0.25
    aiSimSteps: 10
    promotionThreshold: 0.85
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.5
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  9:
    description: "Full-strength predictive-optimized enemy (no training nerfs)"
    shipHP: 1
    maxTicks: 3600
    asteroidDensity: 1.0
    enemyPolicy: "predictive-optimized"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    promotionThreshold: 0.85
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.5
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  10:
    description: "Self-play: fight frozen snapshot of own neural policy"
    shipHP: 1
    maxTicks: 3600
    asteroidDensity: 1.0
    enemyPolicy: "self-play"
    enemyShoots: true
    spawnDistance: 500
    spawnFacing: true
    frameSkip: 2
    selfPlayModelPath: "training/checkpoints/selfplay/opponent_snapshot.onnx"
    promotionThreshold: 0.60
    rewardWeights:
      survival: 0.001
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.5
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -2.0
      timeout: -1.0

  11:
    description: "Full-strength predictive, far spawn, short timeout"
    shipHP: 1
    maxTicks: 1200
    asteroidDensity: 1.0
    enemyPolicy: "predictive-optimized"
    enemyShoots: true
    spawnDistance: [1000, 2000]
    spawnFacing: false
    frameSkip: 2
    campCheckTicks: 0
    promotionThreshold: 0.70
    rewardWeights:
      survival: 0.0
      aim: 0.01
      closing: 0.0
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -3.5
      timeout: -5.0
      engagePenalty: 0.0
      proximity: 3.0

  12:
    description: "Navigate asteroid field and kill stationary target"
    shipHP: 1
    maxTicks: 1200
    asteroidDensity: 0.5
    enemyPolicy: "static"
    enemyShoots: false
    spawnDistance: [1000, 2000]
    spawnFacing: false
    frameSkip: 2
    campCheckTicks: 0
    promotionThreshold: 0.90
    rewardWeights:
      survival: 0.0
      aim: 0.01
      closing: 0.0
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -3.5
      timeout: -5.0
      engagePenalty: 0.0
      proximity: 3.0

  13:
    description: "Navigate asteroid field and engage unarmed self-play camper"
    shipHP: 1
    maxTicks: 1200
    asteroidDensity: 1.0
    enemyPolicy: "self-play"
    enemyShoots: false
    spawnDistance: [1000, 2000]
    spawnFacing: false
    frameSkip: 2
    campCheckTicks: 0
    selfPlayModelPath: "training/checkpoints/selfplay/opponent_snapshot.onnx"
    promotionThreshold: 0.70
    rewardWeights:
      survival: 0.0
      aim: 0.01
      closing: 0.0
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -3.5
      timeout: -5.0
      engagePenalty: 0.0
      proximity: 3.0

  14:
    description: "Self-play, far spawn, short timeout"
    shipHP: 1
    maxTicks: 1200
    asteroidDensity: 1.0
    enemyPolicy: "self-play"
    enemyShoots: true
    spawnDistance: [1000, 2000]
    spawnFacing: false
    frameSkip: 2
    campCheckTicks: 0
    selfPlayModelPath: "training/checkpoints/selfplay/opponent_snapshot.onnx"
    promotionThreshold: 0.80
    rewardWeights:
      survival: 0.0
      aim: 0.01
      closing: 0.0
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -3.5
      timeout: -5.0
      engagePenalty: 0.0
      proximity: 3.0

  15:
    description: "Self-play round 2, far spawn, short timeout"
    shipHP: 1
    maxTicks: 1200
    asteroidDensity: 1.0
    enemyPolicy: "self-play"
    enemyShoots: true
    spawnDistance: [1000, 2000]
    spawnFacing: false
    frameSkip: 2
    campCheckTicks: 0
    selfPlayModelPath: "training/checkpoints/selfplay/opponent_snapshot.onnx"
    promotionThreshold: 0.80
    rewardWeights:
      survival: 0.0
      aim: 0.01
      closing: 0.0
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -3.5
      timeout: -5.0
      engagePenalty: 0.0
      proximity: 3.0

  16:
    description: "Chase fleeing enemy through asteroid field"
    shipHP: 1
    maxTicks: 1200
    asteroidDensity: 0.5
    enemyPolicy: "fleeing"
    enemyShoots: false
    spawnDistance: [500, 1000]
    spawnFacing: false
    frameSkip: 2
    campCheckTicks: 0
    promotionThreshold: 0.85
    rewardWeights:
      survival: 0.0
      aim: 0.01
      closing: 0.01
      hit: 1.0
      gotHit: -1.0
      nearMiss: -0.1
      firePenalty: -0.002
      win: 5.0
      loss: -5.0
      draw: -3.5
      timeout: -5.0
      engagePenalty: 0.0
      proximity: 3.0


